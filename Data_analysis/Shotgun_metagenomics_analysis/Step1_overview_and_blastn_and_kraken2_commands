### This file summarized the commands and programmes used for the data analysis of the shotgun metagenomics datasets.
### Both BLAST and kraken2 analysis were performed in the supercomputer that uses the PBS job schedule system.

# Here is the general commands for BLAST analysis of both quality filtered nanopore reads and illumina contigs
# I used 14 cpus and 300 Gb memory for the analysis
/home/106/yh7166/myapps/ncbi-blast-2.10.0+/bin/blastn -query $query 
                                                      -db $db 
                                                      -evalue 0.01 
                                                      -outfmt '6 qseqid sseqid evalue bitscore length pident nident sgi sacc staxids sscinames scomnames sskingdoms sstart send' 
                                                      -show_gis 
                                                      -num_threads $threads | sort -k1,1 -k4,4nr | sort -u -k1,1 --merge > $output
                                                      # The sort commands above is to extract the best hit for each blast query

# Here is the general commands for kraken2 analysis of both quality filtered nanopore reads and illumina contigs
# I used 16 cpus and 150 Gb memory for the analysis
module load kraken2/2.0.8
export KRAKEN2_DB_PATH="/scratch/cq95/yh7166/db:"
kraken2 --db $db --threads $threads ./${query} > ${OUTPUT}/MC1_read.${dbname}_output


### Overview
# After the Step1 of classification, the Step2 is to parse taxonomic information from the output files. After this step we could plot figure 1 using Plot_figure1 script.
# Step3 is to apply progressive cut-offs on the blast result against fungal database. After this step we could plot figure 2 using the Plot_figure2 script.
# Step4 is to assess and select cut-offs for the blast results from publically available datasets. After this step we could plot figure 3B using the Plot_figure3B script.
# Step5 is to generate the community composition for each datasets, and compare the similarity of them with the gold standard analysis. This step is partially done in the Plot_figure5B script
# Step6 is to apply progressive cut-offs on the query coverage and re-calculate the change of similarities between the gold standard classification and the 'best practice' of each dataset.
